# ì‹¤ì‚¬ë¹„ ì¡°ì • ìµœì¢… ìˆ˜ì • ì™„ë£Œ

## ğŸ› ë°œê²¬ëœ ë²„ê·¸

### ë¬¸ì œì 
ë§¤ì¶œìƒì„¸ëª¨ë‹¬ì—ì„œ ì‹¤ì‚¬ë¹„ ì¡°ì • ê°’ì„ ì…ë ¥í•˜ê³  ì €ì¥ ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ "ì‹¤ì‚¬ë¹„ ì¡°ì • ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤" ì—ëŸ¬ ë°œìƒ

### ê·¼ë³¸ ì›ì¸
**íŒŒì¼**: `app/api/business-info-direct/route.ts`
**ë¼ì¸**: 349 (ìˆ˜ì • ì „)

```typescript
// âŒ ë¬¸ì œ ì½”ë“œ
if (updateData.survey_fee_adjustment !== undefined) {
  updateObject.survey_fee_adjustment = parseInt(updateData.survey_fee_adjustment) || null;
}
```

**ì™œ ë¬¸ì œì¸ê°€?**
1. `parseInt(0)` â†’ `0` â†’ `0 || null` â†’ `null` (0ì´ falsy ê°’ìœ¼ë¡œ ì²˜ë¦¬)
2. `parseInt('')` â†’ `NaN` â†’ `NaN || null` â†’ `null`
3. **ê²°ê³¼**: 0ì„ ì…ë ¥í•´ë„ nullë¡œ ì €ì¥ë˜ì–´ ì‚¬ìš©ì ì˜ë„ì™€ ë‹¤ë¥¸ ë™ì‘

### í•´ê²° ë°©ë²•

```typescript
// âœ… ìˆ˜ì •ëœ ì½”ë“œ (ë¼ì¸ 348-356)
if (updateData.survey_fee_adjustment !== undefined) {
  // null, undefined, ë¹ˆ ë¬¸ìì—´ì´ë©´ nullë¡œ, ê·¸ ì™¸ì—ëŠ” parseInt
  if (updateData.survey_fee_adjustment === null ||
      updateData.survey_fee_adjustment === '' ||
      updateData.survey_fee_adjustment === undefined) {
    updateObject.survey_fee_adjustment = null;
  } else {
    const numValue = parseInt(updateData.survey_fee_adjustment);
    updateObject.survey_fee_adjustment = isNaN(numValue) ? null : numValue;
  }
}
```

**ê°œì„  ì‚¬í•­:**
1. **ëª…ì‹œì  null ì²´í¬**: null, undefined, ë¹ˆ ë¬¸ìì—´ì„ ëª…ì‹œì ìœ¼ë¡œ ì²˜ë¦¬
2. **0 ê°’ ë³´ì¡´**: `parseInt(0)` â†’ `0`, NaN ì²´í¬ í›„ 0 ìœ ì§€
3. **NaN ë°©ì§€**: `isNaN()` ì²´í¬ë¡œ ì˜ëª»ëœ ì…ë ¥ ë°©ì§€

## ğŸ“Š í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤

| ì…ë ¥ ê°’ | ê¸°ëŒ€ ê²°ê³¼ | ìˆ˜ì • ì „ ê²°ê³¼ | ìˆ˜ì • í›„ ê²°ê³¼ |
|--------|----------|------------|------------|
| `50000` | `50000` | âœ… `50000` | âœ… `50000` |
| `-30000` | `-30000` | âœ… `-30000` | âœ… `-30000` |
| `0` | `0` | âŒ `null` | âœ… `0` |
| `''` (ë¹ˆì¹¸) | `null` | âœ… `null` | âœ… `null` |
| `null` | `null` | âœ… `null` | âœ… `null` |
| `undefined` | `null` | âœ… `null` | âœ… `null` |
| `'abc'` | `null` | âŒ `NaN â†’ null` | âœ… `null` |

## ğŸ” ë™ì¼í•œ íŒ¨í„´ ê²€í† 

### ë‹¤ë¥¸ í•„ë“œì—ì„œ ë™ì¼í•œ ë¬¸ì œ ë°œê²¬

ê°™ì€ íŒŒì¼ì—ì„œ ë™ì¼í•œ íŒ¨í„´ì„ ì‚¬ìš©í•˜ëŠ” í•„ë“œë“¤:
- `additional_cost` (ë¼ì¸ 342-344)
- `installation_extra_cost` (ë¼ì¸ 345-347)
- `multiple_stack_cost` (ë¼ì¸ 354-356)

**ì ì¬ì  ìœ„í—˜:**
ì´ë“¤ í•„ë“œë„ 0 ê°’ì„ ì…ë ¥í•˜ë©´ nullë¡œ ì €ì¥ë  ìˆ˜ ìˆìŒ

**ê¶Œì¥ ì¡°ì¹˜:**
ì¶”í›„ ë™ì¼í•œ ìˆ˜ì • íŒ¨í„´ ì ìš© ê³ ë ¤ (í˜„ì¬ëŠ” survey_fee_adjustmentë§Œ ìˆ˜ì •)

## âœ… ìˆ˜ì • ì™„ë£Œ ì‚¬í•­

1. âœ… API í•„ë“œ ì²˜ë¦¬ ë¡œì§ ìˆ˜ì • ([app/api/business-info-direct/route.ts:348-356](app/api/business-info-direct/route.ts#L348-L356))
2. âœ… ê°œë°œ ì„œë²„ ì¬ì‹œì‘ (ë³€ê²½ì‚¬í•­ ë°˜ì˜)
3. âœ… ë¬¸ì„œ ì—…ë°ì´íŠ¸ (ì´ íŒŒì¼)

## ğŸ§ª í…ŒìŠ¤íŠ¸ ê°€ì´ë“œ

### ë§¤ì¶œìƒì„¸ëª¨ë‹¬ í…ŒìŠ¤íŠ¸ (ì‹œí¬ë¦¿ ëª¨ë“œ)

1. **ì‚¬ì—…ì¥ ìƒì„¸ë³´ê¸° â†’ ë§¤ì¶œìƒì„¸ë³´ê¸° í´ë¦­**
2. **ì‹¤ì‚¬ë¹„ìš© ì¹´ë“œì—ì„œ "ìˆ˜ì •" ë˜ëŠ” "ì¡°ì •" ë²„íŠ¼ í´ë¦­**

#### í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

**ì‹œë‚˜ë¦¬ì˜¤ 1: ì–‘ìˆ˜ ì¡°ì •**
- ì…ë ¥: `50000`
- ì˜ˆìƒ: ì„±ê³µ ë©”ì‹œì§€, "ì¡°ì •ë¨" ë…¹ìƒ‰ ë°°ì§€, ê¸°ë³¸ + 50,000ì› í‘œì‹œ

**ì‹œë‚˜ë¦¬ì˜¤ 2: ìŒìˆ˜ ì¡°ì •**
- ì…ë ¥: `-30000`
- ì˜ˆìƒ: ì„±ê³µ ë©”ì‹œì§€, "ì¡°ì •ë¨" ë¹¨ê°„ìƒ‰ ë°°ì§€, ê¸°ë³¸ - 30,000ì› í‘œì‹œ

**ì‹œë‚˜ë¦¬ì˜¤ 3: 0ì› ì¡°ì •** (âš ï¸ ì´ì „ì— ì‹¤íŒ¨í–ˆë˜ ì¼€ì´ìŠ¤)
- ì…ë ¥: `0`
- ì˜ˆìƒ: ì„±ê³µ ë©”ì‹œì§€, 0 ì €ì¥ (null ì•„ë‹˜)

**ì‹œë‚˜ë¦¬ì˜¤ 4: ì¡°ì • ì œê±°**
- ì…ë ¥: ë¹ˆì¹¸
- ì˜ˆìƒ: ì„±ê³µ ë©”ì‹œì§€, "ì¡°ì • ì—†ìŒ" ë°°ì§€ í‘œì‹œ

**ì‹œë‚˜ë¦¬ì˜¤ 5: ì €ì¥ í›„ ëª¨ë‹¬ ì¬ì˜¤í”ˆ**
- ë™ì‘: ì €ì¥ â†’ ëª¨ë‹¬ ë‹«ê¸° â†’ ë‹¤ì‹œ ë§¤ì¶œìƒì„¸ë³´ê¸°
- ì˜ˆìƒ: ì €ì¥í•œ ê°’ ê·¸ëŒ€ë¡œ í‘œì‹œë¨

## ğŸ¯ ì—ëŸ¬ ë©”ì‹œì§€ ë¶„ì„

### "ì‹¤ì‚¬ë¹„ ì¡°ì • ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤" ì—ëŸ¬ì˜ ì›ì¸

1. **API ì‘ë‹µ ì‹¤íŒ¨**: `response.ok === false` ë˜ëŠ” `data.success === false`
2. **ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜**: fetch ìš”ì²­ ìì²´ê°€ ì‹¤íŒ¨
3. **ì„œë²„ ë¡œì§ ì˜¤ë¥˜**: updateObject ì²˜ë¦¬ ì¤‘ ì˜ˆì™¸ ë°œìƒ

ì´ë²ˆ ê²½ìš°:
- **ê·¼ë³¸ ì›ì¸**: 0 ê°’ì´ nullë¡œ ë³€í™˜ë˜ì–´ ì‚¬ìš©ì ì˜ë„ì™€ ë‹¤ë¥´ê²Œ ì €ì¥
- **ì¦ìƒ**: APIëŠ” ì„±ê³µí–ˆì§€ë§Œ ì €ì¥ëœ ê°’ì´ ì˜ˆìƒê³¼ ë‹¤ë¦„
- **í•´ê²°**: ëª…ì‹œì  null ì²´í¬ ë° 0 ê°’ ë³´ì¡´ ë¡œì§ ì¶”ê°€

## ğŸ“… ìˆ˜ì • ì™„ë£Œì¼
2025-12-01

## ğŸ”— ê´€ë ¨ ë¬¸ì„œ
- [êµ¬í˜„ ìƒì„¸ ë¬¸ì„œ](survey-fee-adjustment-implementation.md)
- [ë²„ê·¸ ìˆ˜ì • ìš”ì•½](survey-fee-adjustment-fix-summary.md)
- [í…ŒìŠ¤íŠ¸ ê²€ì¦ ê°€ì´ë“œ](survey-fee-adjustment-test-validation.md)
